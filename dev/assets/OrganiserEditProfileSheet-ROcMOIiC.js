import{a as l,j as e,A as v,m as a}from"./vendor-motion-CtvpaCTF.js";import{n as ee,o as O,a as w,G as se,I as te,J as re,g as L,O as E,j as m,X as z,V as ae,h as $,F as ie,W as R,s as ne,m as oe}from"./index-Bbd_1pDH.js";import{L as le}from"./link-2-CDWkLaQZ.js";import"./vendor-maps-DdmUqcD-.js";const ce=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],de=ee("eye",ce),h={hidden:{opacity:0,y:12},show:i=>({opacity:1,y:0,transition:{type:"spring",damping:25,stiffness:400,delay:i*.06}})};function pe(){const i=O(s=>s.user),T=O(s=>s.setUser),y=w(s=>s.showOrganiserEditProfile),B=w(s=>s.setShowOrganiserEditProfile),b=w(s=>s.showToast),[n,D]=l.useState(i?.organiserDisplayName||i?.name||""),[c,A]=l.useState(i?.organiserBio||""),[o,V]=l.useState(i?.organiserCategories||[]),[d,I]=l.useState(i?.organiserSocialLinks||{}),[x,N]=l.useState(i?.organiserCoverPhoto||""),[u,k]=l.useState(!1),[j,U]=l.useState(!1),[f,F]=l.useState(!1),J=l.useRef({displayName:i?.organiserDisplayName||i?.name||"",organiserBio:i?.organiserBio||"",selectedCategories:i?.organiserCategories||[],socialLinks:i?.organiserSocialLinks||{},coverPhotoPreview:i?.organiserCoverPhoto||""}),S=()=>{const s=J.current;return n!==s.displayName||c!==s.organiserBio||JSON.stringify(o)!==JSON.stringify(s.selectedCategories)||JSON.stringify(d)!==JSON.stringify(s.socialLinks)||x!==s.coverPhotoPreview},p=()=>{S()&&!u&&!window.confirm("You have unsaved changes. Discard them?")||B(!1)};se(p);const G=te(y),{sheetY:M,handleProps:Y}=re(p),_=L.filter(s=>s.id!=="All"),K=s=>{V(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s])},W=(s,t)=>{I(r=>({...r,[s]:t}))},q=(s,t)=>{if(!t?.trim())return null;const r=t.trim();if(s==="website"){if(!/^https?:\/\/.+\..+/.test(r))return"Enter a valid URL (https://...)"}else if(/\s/.test(r))return"Usernames cannot contain spaces";return null},C=E.reduce((s,t)=>{const r=q(t.key,d[t.key]);return r&&(s[t.key]=r),s},{}),H=Object.keys(C).length>0,g=n.trim().length>=2&&o.length>=1&&!H,[P,X]=l.useState(0),Q=async()=>{if(!u){if(!g){X(s=>s+1),m();return}k(!0);try{const s=await ne.updateProfile({organiserDisplayName:n.trim(),organiserBio:c.trim(),organiserCategories:o,organiserSocialLinks:Object.fromEntries(Object.entries(d).filter(([,t])=>t?.trim())),organiserCoverPhoto:x.trim()||null});T(s),oe(),b("Organiser profile updated!","success"),p()}catch(s){b(s.message||"Failed to update profile","error")}finally{k(!1)}}};return y?e.jsx(v,{children:y&&e.jsx(a.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 bg-secondary/60 backdrop-blur-sm flex items-end md:items-center justify-center",onPointerDown:s=>{s.target===s.currentTarget&&p()},children:e.jsxs(a.div,{ref:G,initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:30,stiffness:400},style:{y:M},className:"bg-paper rounded-t-[32px] md:rounded-[32px] w-full md:max-w-lg max-h-[90vh] flex flex-col",role:"dialog","aria-modal":"true","aria-label":"Edit organiser profile",children:[e.jsx("div",{...Y,className:"flex justify-center pt-3 pb-2 cursor-grab active:cursor-grabbing",children:e.jsx("div",{className:"w-10 h-1 bg-secondary/20 rounded-full"})}),e.jsxs("div",{className:"px-6 pb-4 flex items-center justify-between border-b border-secondary/10",children:[e.jsx("h2",{className:"text-lg font-black text-secondary",children:"Edit Profile"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{m(),F(!f)},className:`w-10 h-10 rounded-full flex items-center justify-center transition-colors ${f?"bg-primary/10 text-primary":"bg-secondary/10 text-secondary/60"}`,"aria-label":f?"Hide preview":"Show preview",children:e.jsx(de,{size:18})}),e.jsx("button",{onPointerDown:()=>{m(),p()},className:"w-10 h-10 rounded-full bg-secondary/10 flex items-center justify-center","aria-label":"Close",children:e.jsx(z,{size:20,className:"text-secondary/60"})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",style:{overscrollBehavior:"contain"},children:[e.jsx(v,{children:f&&e.jsx(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsxs("div",{className:"premium-card p-4 rounded-2xl relative overflow-hidden mb-2",children:[e.jsx("p",{className:"text-[9px] font-black text-primary/60 uppercase tracking-widest mb-3",children:"Preview"}),x&&e.jsx("div",{className:"-mx-4 -mt-8 mb-3 h-16 overflow-hidden rounded-t-2xl",children:e.jsx("img",{src:x,className:"w-full h-full object-cover opacity-60",alt:""})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl overflow-hidden bg-secondary/10 shrink-0",children:e.jsx("img",{src:i?.avatar,className:"w-full h-full object-cover",alt:""})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-black text-secondary truncate",children:n.trim()||"Your Name"}),o.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mt-0.5",children:[o.slice(0,3).map(s=>{const t=L.find(r=>r.id===s);return e.jsx("span",{className:"text-[8px] font-bold text-primary bg-primary/5 px-1.5 py-0.5 rounded-full",children:t?.label||s},s)}),o.length>3&&e.jsxs("span",{className:"text-[8px] text-secondary/40",children:["+",o.length-3]})]})]})]}),c.trim()&&e.jsx("p",{className:"text-[11px] text-secondary/50 mt-2 line-clamp-2",children:c})]})})}),e.jsxs(a.div,{custom:0,variants:h,initial:"hidden",animate:"show",children:[e.jsx("label",{className:"text-xs font-black text-secondary/60 uppercase tracking-widest mb-2 block",children:"Cover Photo"}),e.jsx("div",{className:"relative h-24 rounded-2xl overflow-hidden bg-secondary/5 border-2 border-dashed border-secondary/20",children:x?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:x,className:"w-full h-full object-cover",alt:"Cover"}),e.jsx("button",{onClick:()=>N(""),className:"absolute top-2 right-2 w-7 h-7 rounded-full bg-secondary/80 flex items-center justify-center","aria-label":"Remove cover photo",children:e.jsx(z,{size:14,className:"text-white"})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center gap-1",children:[e.jsx(ae,{size:20,className:"text-secondary/30"}),e.jsx("span",{className:"text-[10px] font-bold text-secondary/30",children:"Paste image URL below"})]})}),e.jsx("input",{type:"text",placeholder:"https://example.com/cover-photo.jpg",value:x,onChange:s=>N(s.target.value),className:"w-full mt-2 bg-secondary/5 border border-secondary/20 rounded-xl px-3 py-2 text-sm font-medium text-[var(--text)] focus:outline-none focus:border-primary transition-all placeholder:text-secondary/40"})]}),e.jsxs(a.div,{custom:1,variants:h,initial:"hidden",animate:"show",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-black text-secondary/60 uppercase tracking-widest",children:"Display Name"}),e.jsxs("span",{className:`text-[10px] font-bold ${n.length>=2?"text-green-600":"text-secondary/40"}`,children:[n.length,"/50"]})]}),e.jsx("input",{type:"text",placeholder:"How attendees will see you",value:n,onChange:s=>D(s.target.value),className:"w-full bg-secondary/5 border-2 border-secondary/20 rounded-2xl px-4 py-3.5 text-base font-medium text-[var(--text)] focus:outline-none focus:border-primary transition-all placeholder:text-secondary/40",maxLength:50}),n.trim().length>0&&n.trim().length<2&&e.jsx("p",{className:"text-[10px] text-red-500/70 mt-1 font-medium",children:"Name must be at least 2 characters"}),e.jsx("div",{className:"w-full h-0.5 bg-secondary/10 rounded-full mt-1.5 overflow-hidden",children:e.jsx(a.div,{className:`h-full rounded-full ${n.length>=2?"bg-green-500/60":"bg-primary/40"}`,animate:{width:`${Math.min(n.length/50*100,100)}%`},transition:{duration:.2}})})]}),e.jsxs(a.div,{custom:2,variants:h,initial:"hidden",animate:"show",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-xs font-black text-secondary/60 uppercase tracking-widest",children:"Organiser Bio"}),e.jsxs("span",{className:`text-[10px] font-bold ${c.length>250?"text-amber-500":"text-secondary/40"}`,children:[c.length,"/300"]})]}),e.jsx("textarea",{placeholder:"Tell people what kind of events you host...",value:c,onChange:s=>A(s.target.value),className:"w-full bg-secondary/5 border-2 border-secondary/20 rounded-2xl px-4 py-3 text-sm font-medium text-[var(--text)] focus:outline-none focus:border-primary transition-all placeholder:text-secondary/40 min-h-[100px] resize-none",maxLength:300,style:{overflowWrap:"break-word",wordBreak:"break-words"}}),e.jsx("div",{className:"w-full h-0.5 bg-secondary/10 rounded-full mt-1 overflow-hidden",children:e.jsx(a.div,{className:`h-full rounded-full ${c.length>250?"bg-amber-500/60":"bg-primary/40"}`,animate:{width:`${Math.min(c.length/300*100,100)}%`},transition:{duration:.2}})})]}),e.jsxs(a.div,{custom:3,variants:h,initial:"hidden",animate:"show",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-xs font-black text-secondary/60 uppercase tracking-widest",children:"Event Categories"}),e.jsxs("span",{className:`text-[10px] font-bold ${o.length>=1?"text-green-600":"text-red-500/70"}`,children:[o.length," selected"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(s=>{const t=o.includes(s.id),r=s.icon;return e.jsxs(a.button,{onClick:()=>{K(s.id),m()},whileTap:{scale:.92},animate:t?{scale:[1,1.05,1]}:{},transition:{duration:.2},className:`inline-flex items-center gap-1.5 px-3 py-2 rounded-xl border-2 text-sm font-bold transition-colors ${t?"bg-primary/10 border-primary text-primary":"bg-secondary/5 border-secondary/20 text-secondary/70 hover:border-secondary/40"}`,children:[r&&e.jsx(r,{size:14}),s.label,t&&e.jsx(a.span,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:15,stiffness:400},children:e.jsx($,{size:12})})]},s.id)})}),o.length===0&&e.jsx("p",{className:"text-[10px] text-red-500/70 mt-1 font-medium",children:"Select at least 1 category"})]}),e.jsxs(a.div,{custom:4,variants:h,initial:"hidden",animate:"show",children:[e.jsxs("button",{onClick:()=>{U(!j),m()},className:"w-full flex items-center justify-between mb-3",children:[e.jsxs("label",{className:"text-xs font-black text-secondary/60 uppercase tracking-widest pointer-events-none",children:["Social Links ",e.jsx("span",{className:"text-secondary/30",children:"(optional)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[Object.values(d).filter(s=>s?.trim()).length>0&&e.jsxs("span",{className:"text-[10px] font-bold text-green-600 bg-green-500/10 px-1.5 py-0.5 rounded-full",children:[Object.values(d).filter(s=>s?.trim()).length," linked"]}),e.jsx(ie,{size:14,className:`text-secondary/40 transition-transform ${j?"rotate-180":""}`})]})]}),e.jsx(v,{children:j&&e.jsx(a.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsx("div",{className:"space-y-3",children:E.map(s=>{const t=C[s.key],r=d[s.key]?.trim();return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 border transition-colors ${r?"bg-green-500/5 border-green-500/20":"bg-secondary/5 border-secondary/10"}`,children:e.jsx(le,{size:16,className:r?"text-green-600":"text-secondary/50"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-[10px] font-bold text-secondary/40 uppercase tracking-wider",children:s.label}),e.jsx("input",{type:"text",placeholder:s.placeholder,value:d[s.key]||"",onChange:Z=>W(s.key,Z.target.value),className:`w-full bg-secondary/5 border rounded-xl px-3 py-2 text-sm font-medium text-[var(--text)] focus:outline-none transition-all placeholder:text-secondary/40 ${t?"border-red-400 focus:border-red-500":r?"border-green-500/30 focus:border-green-500":"border-secondary/20 focus:border-primary"}`}),t&&e.jsx("p",{className:"text-[10px] text-red-500/70 mt-0.5 font-medium",children:t})]})]},s.key)})})})})]}),e.jsx(a.div,{custom:5,variants:h,initial:"hidden",animate:"show",children:i?.organiserVerified?e.jsxs("div",{className:"flex items-center gap-2 p-3 rounded-2xl bg-green-500/5 border border-green-500/10",children:[e.jsx(R,{size:16,className:"text-green-600"}),e.jsx("span",{className:"text-sm font-bold text-green-600",children:"Verified Organiser"})]}):e.jsx("div",{className:"premium-card p-4 rounded-2xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center shrink-0",children:e.jsx(R,{size:18,className:"text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-secondary",children:"Get Verified"}),e.jsx("p",{className:"text-[10px] text-secondary/40",children:"Verified organisers get a badge on their profile"})]}),e.jsx("button",{onClick:()=>{m(),b("Verification request submitted! We'll review your profile.","success")},className:"px-3 py-1.5 rounded-xl bg-primary/10 border border-primary/20 text-primary text-[11px] font-bold hover:bg-primary/20 transition-colors",children:"Request"})]})})})]}),e.jsxs("div",{className:"p-6 pb-8 border-t border-secondary/10",children:[S()&&e.jsx(a.p,{initial:{opacity:0,y:4},animate:{opacity:1,y:0},className:"text-[10px] font-bold text-amber-500 text-center mb-2",children:"You have unsaved changes"}),e.jsx(a.button,{onClick:Q,disabled:u,whileTap:g?{scale:.98}:{},animate:!g&&P>0?{x:[0,-6,6,-4,4,0]}:{},transition:{duration:.3},className:`w-full h-14 rounded-2xl font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all ${g?"bg-gradient-to-r from-primary to-accent text-white":"bg-secondary/20 text-secondary/40 cursor-not-allowed"} ${u?"opacity-50":""}`,children:u?e.jsx(a.div,{animate:{rotate:360},transition:{repeat:1/0,duration:.8,ease:"linear"},className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full"}):e.jsxs(e.Fragment,{children:[e.jsx($,{size:20}),"Save Changes"]})},P)]})]})})}):null}export{pe as default};
